<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Configuration Files | Watchman</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Configuration Files" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Watchman looks for configuration files in two places:" />
<meta property="og:description" content="Watchman looks for configuration files in two places:" />
<link rel="canonical" href="https://facebook.github.io/watchman/docs/config.html" />
<meta property="og:url" content="https://facebook.github.io/watchman/docs/config.html" />
<meta property="og:site_name" content="Watchman" />
<meta property="og:image" content="https://facebook.github.io/watchman/static/og_image.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-03T15:40:25+00:00" />
<script type="application/ld+json">
{"headline":"Configuration Files","url":"https://facebook.github.io/watchman/docs/config.html","dateModified":"2020-12-03T15:40:25+00:00","datePublished":"2020-12-03T15:40:25+00:00","description":"Watchman looks for configuration files in two places:","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://facebook.github.io/watchman/static/logo.png"}},"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://facebook.github.io/watchman/docs/config.html"},"image":"https://facebook.github.io/watchman/static/og_image.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" type="text/css" media="screen" href="/watchman/css/main.css">
  <link rel="icon" href="static/favicon.png" type="image/x-icon">

  <script async defer src="//cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react-with-addons.min.js"></script>
  <script async defer src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>

  
  <link type="application/atom+xml" rel="alternate" href="https://facebook.github.io/watchman/feed.xml" title="Watchman" />
</head>

  <body>    
    <div id="fixed_header" class="fixedHeaderContainer visible">
  <header>
    <a href="https://facebook.github.io/watchman/"><img src="/watchman/static/logo.png" /><h2>Watchman</h2></a>
    <div class="navigationWrapper navigationFull" id="flat_nav">
      <nav class="navigation">
        <ul>
          
          <li class="navItem navItemActive">
            <a href=/watchman/docs/install.html>Docs</a>
          </li>
          
          <li class="navItem ">
            <a href=/watchman/support.html>Support</a>
          </li>
          
          <li class="navItem ">
            <a href=http://github.com/facebook/watchman>GitHub</a>
          </li>
          
        </ul>
      </nav>
    </div>
    <div class="navigationWrapper navigationSlider" id="navigation_wrap"></div>
  </header>
  <script>
    var event = document.createEvent('Event');
    event.initEvent('slide', true, true);
    document.addEventListener('slide', function (e) {
      document.body.classList.toggle('sliderActive');
    }, false);
    var navData = [
      
      {
        href       : "/watchman/docs/install.html",
        text       : "Docs",
      },
      
      {
        href       : "/watchman/support.html",
        text       : "Support",
      },
      
      {
        href       : "http://github.com/facebook/watchman",
        text       : "GitHub",
      },
      
    ];
  </script>
  <script type="text/javascript">  
  window.addEventListener('load', function() {
    var Nav = React.createClass({displayName: "Nav",
      getInitialState: function() {
        return {
          currentPath: window.location.pathname,
          slideoutActive: false,
        };
      },
      getDefaultProps: function() {
        return {
          data: navData,
        }
      },
      handleClick: function(id) {
        this.setState({
          slideoutActive: false,
        });
        document.dispatchEvent(event);
      },
      handleSlide: function(id) {
        this.setState({
          slideoutActive: !this.state.slideoutActive,
        });
        document.dispatchEvent(event);
      },
      render: function() {
        var classes = React.addons.classSet({
          'navSlideout': true,
          'navSlideoutActive': this.state.slideoutActive,
        });
        var navClasses = React.addons.classSet({
          'slidingNav': true,
          'slidingNavActive': this.state.slideoutActive,
        });
        return (
          React.createElement("div", null, 
            React.createElement("div", {className: classes, onClick: this.handleSlide}, 
              React.createElement("i", {className: "fa fa-bars"})
            ), 
            React.createElement("nav", {className: navClasses}, 
              React.createElement("ul", null, 
                this.props.data.map(this.renderNavItems)
              )
            )
          )
        );
      },
      renderNavItems: function(child, index) {
        var classes = React.addons.classSet({
          'navItem': true,
          'navItemActive': this.state.currentPath === child.href,
        });
        return (
          React.createElement("li", {key: index, className: classes}, 
            React.createElement("a", {onClick: this.handleClick, href: child.href}, child.text)
          )
        );
      },
    });

    function render(navData) {
      React.render(
        React.createElement(Nav, {data: navData}),
        document.getElementById('navigation_wrap')
      );
    }
    render(navData);
  });
  </script>
</div>

    <div class="navPusher">
      <div class="mainContainer blogContainer postContainer">
  <div id="main_wrap" class="wrapper mainWrapper">
    <div>
</div>
<nav class='toc' id="doc_nav"></nav>
<script>
  var docnavData = [
    
    {
      group     : "Installation",
      items     : [
        
          
        {
          key : "/watchman/docs/install.html",
          title : "Installation",
          url : "/watchman/docs/install.html",
        },
        
          
        {
          key : "/watchman/docs/release-notes.html",
          title : "Release Notes",
          url : "/watchman/docs/release-notes.html",
        }
        
      ],
    },
    
    {
      group     : "Invocation",
      items     : [
        
          
        {
          key : "/watchman/docs/cli-options.html",
          title : "Command Line",
          url : "/watchman/docs/cli-options.html",
        },
        
          
        {
          key : "/watchman/docs/watchman-make.html",
          title : "watchman-make",
          url : "/watchman/docs/watchman-make.html",
        },
        
          
        {
          key : "/watchman/docs/watchman-wait.html",
          title : "watchman-wait",
          url : "/watchman/docs/watchman-wait.html",
        },
        
          
        {
          key : "/watchman/docs/watchman-replicate-subscription.html",
          title : "watchman-replicate-subscription",
          url : "/watchman/docs/watchman-replicate-subscription.html",
        },
        
          
        {
          key : "/watchman/docs/cppclient.html",
          title : "C++ Client",
          url : "/watchman/docs/cppclient.html",
        },
        
          
        {
          key : "/watchman/docs/nodejs.html",
          title : "NodeJS",
          url : "/watchman/docs/nodejs.html",
        },
        
          
        {
          key : "/watchman/docs/config.html",
          title : "Configuration Files",
          url : "/watchman/docs/config.html",
        },
        
          
        {
          key : "/watchman/docs/socket-interface.html",
          title : "Socket Interface",
          url : "/watchman/docs/socket-interface.html",
        }
        
      ],
    },
    
    {
      group     : "Compatibility",
      items     : [
        
          
        {
          key : "/watchman/docs/compatibility.html",
          title : "Compatibility Rules",
          url : "/watchman/docs/compatibility.html",
        },
        
          
        {
          key : "/watchman/docs/capabilities.html",
          title : "Capabilities",
          url : "/watchman/docs/capabilities.html",
        }
        
      ],
    },
    
    {
      group     : "Commands",
      items     : [
        
          
        {
          key : "/watchman/docs/cmd/clock.html",
          title : "clock",
          url : "/watchman/docs/cmd/clock.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/find.html",
          title : "find",
          url : "/watchman/docs/cmd/find.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/flush-subscriptions.html",
          title : "flush-subscriptions",
          url : "/watchman/docs/cmd/flush-subscriptions.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/get-config.html",
          title : "get-config",
          url : "/watchman/docs/cmd/get-config.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/get-sockname.html",
          title : "get-sockname",
          url : "/watchman/docs/cmd/get-sockname.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/list-capabilities.html",
          title : "list-capabilities",
          url : "/watchman/docs/cmd/list-capabilities.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/log.html",
          title : "log",
          url : "/watchman/docs/cmd/log.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/log-level.html",
          title : "log-level",
          url : "/watchman/docs/cmd/log-level.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/query.html",
          title : "query",
          url : "/watchman/docs/cmd/query.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/shutdown-server.html",
          title : "shutdown-server",
          url : "/watchman/docs/cmd/shutdown-server.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/since.html",
          title : "since",
          url : "/watchman/docs/cmd/since.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/state-enter.html",
          title : "state-enter",
          url : "/watchman/docs/cmd/state-enter.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/state-leave.html",
          title : "state-leave",
          url : "/watchman/docs/cmd/state-leave.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/subscribe.html",
          title : "subscribe",
          url : "/watchman/docs/cmd/subscribe.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/trigger.html",
          title : "trigger",
          url : "/watchman/docs/cmd/trigger.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/trigger-del.html",
          title : "trigger-del",
          url : "/watchman/docs/cmd/trigger-del.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/trigger-list.html",
          title : "trigger-list",
          url : "/watchman/docs/cmd/trigger-list.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/unsubscribe.html",
          title : "unsubscribe",
          url : "/watchman/docs/cmd/unsubscribe.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/version.html",
          title : "version",
          url : "/watchman/docs/cmd/version.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/watch.html",
          title : "watch",
          url : "/watchman/docs/cmd/watch.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/watch-del.html",
          title : "watch-del",
          url : "/watchman/docs/cmd/watch-del.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/watch-del-all.html",
          title : "watch-del-all",
          url : "/watchman/docs/cmd/watch-del-all.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/watch-list.html",
          title : "watch-list",
          url : "/watchman/docs/cmd/watch-list.html",
        },
        
          
        {
          key : "/watchman/docs/cmd/watch-project.html",
          title : "watch-project",
          url : "/watchman/docs/cmd/watch-project.html",
        }
        
      ],
    },
    
    {
      group     : "Queries",
      items     : [
        
          
        {
          key : "/watchman/docs/clockspec.html",
          title : "Clockspec",
          url : "/watchman/docs/clockspec.html",
        },
        
          
        {
          key : "/watchman/docs/file-query.html",
          title : "File Queries",
          url : "/watchman/docs/file-query.html",
        },
        
          
        {
          key : "/watchman/docs/simple-query.html",
          title : "Simple Pattern Syntax",
          url : "/watchman/docs/simple-query.html",
        },
        
          
        {
          key : "/watchman/docs/scm-query.html",
          title : "Source Control Aware Queries",
          url : "/watchman/docs/scm-query.html",
        }
        
      ],
    },
    
    {
      group     : "Expression Terms",
      items     : [
        
          
        {
          key : "/watchman/docs/expr/allof.html",
          title : "allof",
          url : "/watchman/docs/expr/allof.html",
        },
        
          
        {
          key : "/watchman/docs/expr/anyof.html",
          title : "anyof",
          url : "/watchman/docs/expr/anyof.html",
        },
        
          
        {
          key : "/watchman/docs/expr/dirname.html",
          title : "dirname & idirname",
          url : "/watchman/docs/expr/dirname.html",
        },
        
          
        {
          key : "/watchman/docs/expr/empty.html",
          title : "empty",
          url : "/watchman/docs/expr/empty.html",
        },
        
          
        {
          key : "/watchman/docs/expr/exists.html",
          title : "exists",
          url : "/watchman/docs/expr/exists.html",
        },
        
          
        {
          key : "/watchman/docs/expr/match.html",
          title : "match & imatch",
          url : "/watchman/docs/expr/match.html",
        },
        
          
        {
          key : "/watchman/docs/expr/name.html",
          title : "name & iname",
          url : "/watchman/docs/expr/name.html",
        },
        
          
        {
          key : "/watchman/docs/expr/not.html",
          title : "not",
          url : "/watchman/docs/expr/not.html",
        },
        
          
        {
          key : "/watchman/docs/expr/pcre.html",
          title : "pcre & ipcre",
          url : "/watchman/docs/expr/pcre.html",
        },
        
          
        {
          key : "/watchman/docs/expr/since.html",
          title : "since",
          url : "/watchman/docs/expr/since.html",
        },
        
          
        {
          key : "/watchman/docs/expr/size.html",
          title : "size",
          url : "/watchman/docs/expr/size.html",
        },
        
          
        {
          key : "/watchman/docs/expr/suffix.html",
          title : "suffix",
          url : "/watchman/docs/expr/suffix.html",
        },
        
          
        {
          key : "/watchman/docs/expr/type.html",
          title : "type",
          url : "/watchman/docs/expr/type.html",
        }
        
      ],
    },
    
    {
      group     : "Internals",
      items     : [
        
          
        {
          key : "/watchman/docs/bser.html",
          title : "BSER Binary Protocol",
          url : "/watchman/docs/bser.html",
        },
        
          
        {
          key : "/watchman/docs/casefolding.html",
          title : "Case-Insensitivity",
          url : "/watchman/docs/casefolding.html",
        },
        
          
        {
          key : "/watchman/contributing.html",
          title : "Contributing",
          url : "/watchman/contributing.html",
        },
        
          
        {
          key : "/watchman/docs/cookies.html",
          title : "Query Synchronization",
          url : "/watchman/docs/cookies.html",
        }
        
      ],
    },
    
    {
      group     : "Troubleshooting",
      items     : [
        
          
        {
          key : "/watchman/docs/troubleshooting.html",
          title : "Troubleshooting",
          url : "/watchman/docs/troubleshooting.html",
        }
        
      ],
    },
    
  ];
</script>
<script type="text/javascript">
window.addEventListener('load', function() {
  var DocNav = React.createClass({displayName: "DocNav",
    getInitialState: function() {
      return {
        toggleActive: false,
      };
    },
    getDefaultProps: function() {
      return {
        currentDoc: "Configuration Files",
        currentGroup: "",
        data: docnavData,
      }
    },
    handleSlide: function(id) {
      this.setState({
        toggleActive: !this.state.toggleActive,
      });
    },
    render: function() {
      var classes = React.addons.classSet({
        'navToggle': true,
        'navToggleActive': this.state.toggleActive,
      });
      var navClasses = React.addons.classSet({
        'toggleNav': true,
        'toggleNavActive': this.state.toggleActive,
      });
      return (
        React.createElement("div", {className: navClasses},
          React.createElement("section", null,
            this.props.data.map(this.renderNavGroups)
          ),
          React.createElement("div", {className: classes, onClick: this.handleSlide}, React.createElement("i", {className: "fa fa-chevron-circle-down"}))
        )
      );
    },
    renderNavGroups: function(child, index) {
      var classes = React.addons.classSet({
        'navGroup': true,
        'navGroupActive': this.props.currentGroup === child.group,
      });
      return (
        React.createElement("div", {className: classes, key: index},
          React.createElement("h3", null, child.group),
          React.createElement("ul", null,
            child.items.map(this.renderNavItems)
          )
        )
      );
    },
    renderNavItems: function(child, index) {
      var itemClasses = React.addons.classSet({
        'navListItem': true,
        'navListItemActive': this.props.currentDoc === child.title,
      });
      var classes = React.addons.classSet({
        'navItem': true,
        'navItemActive': this.props.currentDoc === child.title,
      });
      return (
        React.createElement("li", {className: itemClasses, key: index}, React.createElement("a", {className: classes, href: child.url},  child.title))
      );
    },
  });

  function docNavRender(docnavData) {
    React.render(
      React.createElement(DocNav, {data: docnavData}),
      document.getElementById('doc_nav')
    );
  }
  docNavRender(docnavData);
});
</script>

    <div class="post">
  <header class="post-header">
    <h1 class="post-title">Configuration Files</h1>
  </header>

  <article class="post-content">
   
      <p>Watchman looks for configuration files in two places:</p>

<ul>
  <li>The global configuration file <code class="language-plaintext highlighter-rouge">/etc/watchman.json</code></li>
  <li>The root specific configuration file <code class="language-plaintext highlighter-rouge">.watchmanconfig</code></li>
</ul>

<p>When watching a root, if a valid JSON file named <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> is present
in the root directory, watchman will load it and use it as a source of
configuration information specific to that root.</p>

<p>The global configuration path can be changed by passing the
<code class="language-plaintext highlighter-rouge">--enable-conffile</code> option to configure when you build watchman.  This
documentation refers to it as <code class="language-plaintext highlighter-rouge">/etc/watchman.json</code> throughout, just be aware
that your particular installation may locate it elsewhere.   In addition,
the environmental variable <code class="language-plaintext highlighter-rouge">$WATCHMAN_CONFIG_FILE</code> will override the
default location.</p>

<p>Changes to the <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> or <code class="language-plaintext highlighter-rouge">/etc/watchman.json</code> files are not picked
up automatically; you will need to remove and re-add the watch (for
<code class="language-plaintext highlighter-rouge">.watchmanconfig</code>) or restart watchman (for <code class="language-plaintext highlighter-rouge">/etc/watchman.json</code>) for those
changes to take effect.</p>

<h3 id="resolution--scoping">Resolution / Scoping</h3>

<p>There are three configuration scopes:</p>

<ul>
  <li><strong>local</strong> - the option value is read from the <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> file in the
associated root.</li>
  <li><strong>global</strong> - the option value is read from the <code class="language-plaintext highlighter-rouge">/etc/watchman.json</code> file</li>
  <li><strong>fallback</strong> - the option value is read from the <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> file.
If the option was not present in the <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> file, then read
it from the <code class="language-plaintext highlighter-rouge">/etc/watchman.json</code> file.</li>
</ul>

<p>This table shows the scoping and availability of the various options:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Scope</th>
      <th>Since version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">settle</code></td>
      <td>local</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">root_restrict_files</code></td>
      <td>global</td>
      <td>deprecated in 3.1</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">root_files</code></td>
      <td>global</td>
      <td>3.1</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">enforce_root_files</code></td>
      <td>global</td>
      <td>3.1</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">illegal_fstypes</code></td>
      <td>global</td>
      <td>2.9.8</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">illegal_fstypes_advice</code></td>
      <td>global</td>
      <td>2.9.8</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ignore_vcs</code></td>
      <td>local</td>
      <td>2.9.3</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ignore_dirs</code></td>
      <td>local</td>
      <td>2.9.3</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">gc_age_seconds</code></td>
      <td>local</td>
      <td>2.9.4</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">gc_interval_seconds</code></td>
      <td>local</td>
      <td>2.9.4</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fsevents_latency</code></td>
      <td>fallback</td>
      <td>3.2</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">idle_reap_age_seconds</code></td>
      <td>local</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">hint_num_files_per_dir</code></td>
      <td>fallback</td>
      <td>3.9</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">hint_num_dirs</code></td>
      <td>fallback</td>
      <td>4.6</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">suppress_recrawl_warnings</code></td>
      <td>fallback</td>
      <td>4.7</td>
    </tr>
  </tbody>
</table>

<h3 id="configuration-options">Configuration Options</h3>

<h3 id="settle">settle</h3>

<p>Specifies the settle period in <em>milliseconds</em>.  This controls how long the
filesystem should be idle before dispatching triggers.  The default value is 20
milliseconds.</p>

<h3 id="root_files">root_files</h3>

<p><em>Since 3.1.</em></p>

<p>Specifies a list of files that, if present in a directory, identify that
directory as the root of a project.</p>

<p>If left unspecified, to aid in transitioning between versions, watchman will
use the value of the now deprecated
<a href="#root_restrict_files">root_restrict_files</a> configuration setting.</p>

<p>If neither <code class="language-plaintext highlighter-rouge">root_files</code> nor <code class="language-plaintext highlighter-rouge">root_restrict_files</code> is specified in the
configuration, watchman will use a default value consisting of:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">.git</code></li>
  <li><code class="language-plaintext highlighter-rouge">.hg</code></li>
  <li><code class="language-plaintext highlighter-rouge">.svn</code></li>
  <li><code class="language-plaintext highlighter-rouge">.watchmanconfig</code></li>
</ul>

<p>Watchman will add <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> to whatever value is specified for
this configuration value if it is not present.</p>

<p>This example causes only <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> to be considered as a project
root file:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="rougeHighlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"root_files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">".watchmanconfig"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>See the <a href="cmd/watch-project.html">watch-project</a> command for more information.</p>

<h3 id="enforce_root_files">enforce_root_files</h3>

<p><em>Since 3.1.</em></p>

<p>This is a boolean option that defaults to <code class="language-plaintext highlighter-rouge">false</code>.  If it is set to <code class="language-plaintext highlighter-rouge">true</code>
then the <a href="cmd/watch.html">watch</a> command will only succeed if the requested
directory contains one of the files listed by the <a href="#root_files">root_files</a>
configuration option, and the <a href="cmd/watch-project.html">watch-project</a> command
will only succeed if a valid project root is found.</p>

<p>If left unspecified, to aid in transitioning between versions, watchman will
check to see if the now deprecated <a href="#root_restrict_files">root_restrict_files</a>
configuration setting is present.  If it is found then the effective value of
<code class="language-plaintext highlighter-rouge">enforce_root_files</code> is set to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h3 id="root_restrict_files">root_restrict_files</h3>

<p><em>Deprecated starting in version 3.1; use <a href="#root_files">root_files</a> and
<a href="#enforce_root_files">enforce_root_files</a> to effect the same behavior.</em></p>

<p>Specifies a list of files, at least one of which should be present in a
directory for watchman to add it as a root. By default there are no
restrictions.</p>

<p>For example,</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="rougeHighlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"root_restrict_files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">".git"</span><span class="p">,</span><span class="w"> </span><span class="s2">".hg"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>will allow watches only in the top level of Git or Mercurial repositories.</p>

<h3 id="illegal_fstypes">illegal_fstypes</h3>

<p>Specifies a list of filesystem types that watchman is prohibited to attempt to
watch.  Watchman will determine the filesystem type of the root of a watch; if
the typename is present in the <code class="language-plaintext highlighter-rouge">illegal_fstypes</code> list, the watch will be
prohibited.  You may also specify <code class="language-plaintext highlighter-rouge">illegal_fstypes_advice</code> as a string with
additional advice to your user.  The purpose of this configuration option is
largely to prevent the use of Watchman on network mounted filesystems.  On
Linux systems, Watchman may not be able to determine the precise type name of a
mounted filesystem.  If the filesystem type is not known to watchman, it will
be reported as <code class="language-plaintext highlighter-rouge">unknown</code>.</p>

<p>For example,</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="rougeHighlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"illegal_fstypes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"nfs"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cifs"</span><span class="p">,</span><span class="w"> </span><span class="s2">"smb"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"illegal_fstypes_advice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"use a local directory"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>will prevent watching dirs mounted on network filesystems and provide the
advice to use a local directory.  You may omit the <code class="language-plaintext highlighter-rouge">illegal_fstypes_advice</code>
setting to use a default suggestion to relocate the directory to local disk.</p>

<h3 id="ignore_vcs">ignore_vcs</h3>

<p>Apply special VCS ignore logic to the set of named dirs.  This option has a
default value of <code class="language-plaintext highlighter-rouge">[".git", ".hg", ".svn"]</code>.  Dirs that match this option are
observed and watched using special shallow logic.  The shallow watch allows
watchman to mildly abuse the version control directories to store its query
cookie files and to observe VCS locking activity without having to watch the
entire set of VCS data for large trees.</p>

<h3 id="ignore_dirs">ignore_dirs</h3>

<p>Dirs that match are completely ignored by watchman.  This is useful to ignore a
directory that contains only build products and where file change notifications
are unwanted because of the sheer volume of files.</p>

<p>For example,</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="rougeHighlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"ignore_dirs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"build"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>would ignore the <code class="language-plaintext highlighter-rouge">build</code> directory at the top level of the watched tree, and
everything below it.  It will never appear in the watchman query results for
the tree.</p>

<p>On Linux systems, <code class="language-plaintext highlighter-rouge">ignore_dirs</code> is respected at the OS level; the kernel
simply will not tell watchman about changes to ignored dirs.  macOS and Windows
have limited or no support for this, so watchman needs to process and ignore
this class of change.</p>

<p>For large trees or especially busy build dirs, it is recommended that you move
the busy build dirs out of the tree for more optimal performance.</p>

<p>Since version 2.9.9, if you list a dir in <code class="language-plaintext highlighter-rouge">ignore_dirs</code> that is also listed in
<code class="language-plaintext highlighter-rouge">ignore_vcs</code>, the <code class="language-plaintext highlighter-rouge">ignore_dirs</code> placement will take precedence.  This may not
sound like a big deal, but since <code class="language-plaintext highlighter-rouge">ignore_vcs</code> is used as a hint to for the
placement of <a href="/watchman/docs/cookies.html">cookie files</a>, having these two
options overlap in earlier versions would break watchman queries.</p>

<p><em>Since 4.6.</em></p>

<p>On macOS the first 8 items listed in <code class="language-plaintext highlighter-rouge">ignore_dirs</code> can be accelerated at the
OS level.  This means that changes to those paths are not even communicated
to the watchman service.  Entries beyond the first 8 are processed and
ignored by watchman.  If your workload is prone to recrawl events you will
want to prioritize your <code class="language-plaintext highlighter-rouge">ignore_dirs</code> list so that the most busy ignored
locations occupy the first 8 positions in this list.</p>

<h3 id="gc_age_seconds">gc_age_seconds</h3>

<p>Deleted files (and dirs) older than this are periodically pruned from the
internal view of the filesystem.  Until they are pruned, they will be visible
to queries but will have their <code class="language-plaintext highlighter-rouge">exists</code> field set to <code class="language-plaintext highlighter-rouge">false</code>.   Once they are
pruned, watchman will remember the most recent clock value of the pruned nodes.
Any since queries based on a clock prior to the last prune clock will be
treated as a fresh instance query.  This allows a client to detect and choose
how to handle the case where they have missed changes.  See <code class="language-plaintext highlighter-rouge">is_fresh_instance</code>
elsewhere in this document for more information.  The default for this is
<code class="language-plaintext highlighter-rouge">43200</code> (12 hours).</p>

<h3 id="gc_interval_seconds">gc_interval_seconds</h3>

<p>How often to check for, and prune out, deleted nodes per the <code class="language-plaintext highlighter-rouge">gc_age_seconds</code>
option description above.  The default for this is <code class="language-plaintext highlighter-rouge">86400</code> (24 hours).  Set
this to <code class="language-plaintext highlighter-rouge">0</code> to disable the periodic pruning operation.</p>

<h3 id="fsevents_latency">fsevents_latency</h3>

<p>Controls the latency parameter that is passed to <code class="language-plaintext highlighter-rouge">FSEventStreamCreate</code> on macOS.
The value is measured in seconds.  The fixed value of this parameter prior to
version 3.2 of watchman was <code class="language-plaintext highlighter-rouge">0.0001</code> seconds.  Starting in version 3.2 of
watchman, the default is now <code class="language-plaintext highlighter-rouge">0.01</code> seconds and can be controlled on a
per-root basis.</p>

<p>If you observe problems with <code class="language-plaintext highlighter-rouge">kFSEventStreamEventFlagUserDropped</code> increasing
the latency parameter will allow the system to batch more change notifications
together and operate more efficiently.</p>

<h3 id="fsevents_try_resync">fsevents_try_resync</h3>

<p>This is macOS specific.</p>

<p><em>Since 4.6.</em></p>

<p>Defaults to <code class="language-plaintext highlighter-rouge">false</code>.  If set to <code class="language-plaintext highlighter-rouge">true</code>, if a watch receives a
<code class="language-plaintext highlighter-rouge">kFSEventStreamEventFlagUserDropped</code> event, attempt to resync from the
<code class="language-plaintext highlighter-rouge">fsevents</code> journal if it is available.  The journal may not be available if one
or more volumes are mounted read-only, if the administrator has purged the
journal, or if the <code class="language-plaintext highlighter-rouge">fsevents</code> id numbers have rolled over.</p>

<p>This resync operation is advantageous because it effectively allows rewinding
and replaying the event stream from a known point in time and avoids the need
to recrawl the entire watch.</p>

<p>If this option is set to <code class="language-plaintext highlighter-rouge">false</code>, or if the journal is not available, the
original strategy of recrawling the watched directory tree is used instead.</p>

<p><em>Since 4.7.</em></p>

<p>The default changed to <code class="language-plaintext highlighter-rouge">true</code>.  In addition, this resync strategy is now
also applied to <code class="language-plaintext highlighter-rouge">kFSEventStreamEventFlagKernelDropped</code> events.</p>

<h3 id="idle_reap_age_seconds">idle_reap_age_seconds</h3>

<p><em>Since 3.7.</em></p>

<p>How many seconds a watch can remain idle before becoming a candidate for
reaping, measured in seconds.  The default for this is <code class="language-plaintext highlighter-rouge">432000</code> (5 days).  Set
this to <code class="language-plaintext highlighter-rouge">0</code> to prevent reaping.</p>

<p>A watch is considered to be idle when it has had no commands that operate on it
for <code class="language-plaintext highlighter-rouge">idle_reap_age_seconds</code>.   If an idle watch has no triggers and no
subscriptions then it will be cancelled, releasing the associated operating
system resources, and removed from the state file.</p>

<h3 id="hint_num_files_per_dir">hint_num_files_per_dir</h3>

<p><em>Since 3.9.</em></p>

<p>Used to pre-size hash tables used to track files per directory.  This
is most impactful during the initial crawl of the filesystem.  Setting
this too small will increase the chance of a hash insert having a collision
and drive up the cost of the insert and subsequent gets.</p>

<p>Prior to version 3.9 of watchman this value was fixed at <code class="language-plaintext highlighter-rouge">2</code>.  Starting
in version 3.9 the default value is <code class="language-plaintext highlighter-rouge">64</code> and can be configured via this
setting in the <code class="language-plaintext highlighter-rouge">.watchmanconfig</code> or the global <code class="language-plaintext highlighter-rouge">/etc/watchman.json</code>
configuration file.</p>

<p>Setting this value very large increases the memory overhead per directory in
the tree; the value is rounded up to the next power of two and pre-allocated
in an array of pointers.  On a 64-bit system multiply that number by 8 to
arrive at the number of bytes of overhead (halve this on a 32-bit system).
The overhead is doubled when using a case insensitive filesystem.</p>

<p>The ideal size from a time complexity perspective is the number of files in
your largest directory.  From a space complexity perspective, the ideal size
is 1; you would pay the cost of the collisions during the initial crawl and
have a more optimal memory usage.  Since watchman is primarily employed as an
accelerator, we’d recommend biasing towards using more memory and taking less
time to run.</p>

<h3 id="hint_num_dirs">hint_num_dirs</h3>

<p><em>Since 4.6</em></p>

<p>Used to pre-size hash tables that are used to track the total set of files
in the entire watched tree.  The default value for this is 131072.</p>

<p>The optimal size is a power-of-two larger than the number of directories
in your tree; running <code class="language-plaintext highlighter-rouge">find . -type d | wc -l</code> will tell you the number
that you have.</p>

<p>Making this number too large is potentially wasteful of memory.  Making this
number too small results in increased latency during crawling while the
hash tables are rebuilt.</p>

<h3 id="suppress_recrawl_warnings">suppress_recrawl_warnings</h3>

<p><em>Since 4.7</em></p>

<p>When set to <code class="language-plaintext highlighter-rouge">true</code>, watchman will not produce recrawl related warning fields in
the response PDUs of various requests.  The default is <code class="language-plaintext highlighter-rouge">false</code>; the intent is
that someone in your organization should be aware of recrawls and be able to
manage the configuration and workload.  Some sites employ an alternative
mechanism for sampling and reporting this to the right set of people and wish
to disable the warning so that it doesn’t appear in front of users that are
unable to make the appropriate configuration changes for themselves.</p>

    
  </article>
</div>

  </div>
</div>


      <div class="footerContainer">
  <div id="footer_wrap" class="wrapper footerWrapper">
    <section id="fb_oss" class="fbOpenSourceFooter">
      <a href="https://code.facebook.com/projects/" target="_blank"><img src="/watchman/static/oss_logo.png" alt="Facebook Open Source" title="Facebook Open Source" /></a>
    </section>
  </div>
</div>
<script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = window.location.href.replace(window.location.hash, '') + "#" + id;
    anchor.innerHTML = "<i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  window.addEventListener('load', function() {
    var contentBlock = document.getElementsByClassName("post")[0] || document.getElementsByClassName("news")[0];
    if (!contentBlock) {
      return;
    }
    for (var level = 1; level <= 6; level++) {
      linkifyAnchors(level, contentBlock);
    }
  });
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44373548-13', 'auto');
  ga('send', 'pageview');
</script>
<script>
  window.addEventListener('load', function() {
    hljs.initHighlightingOnLoad();

    // Async load some styles
    function loadStyle(href) {
      var s = document.createElement('link');
      s.setAttribute('rel', 'stylesheet');
      s.setAttribute('href', href);
      s.setAttribute('type', 'text/css');
      document.getElementsByTagName('head')[0].appendChild(s);
    }
    loadStyle("//nuclide.io/static/fonts/332720/BC699FA675F9356E3.css");
    loadStyle("//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css");
    loadStyle("//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css");
  });
</script>

    </div>
  </body>

</html>
